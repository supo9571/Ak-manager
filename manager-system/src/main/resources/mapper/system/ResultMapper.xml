<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.manager.system.mapper.ResultMapper">
    <select id="getGameResult" resultType="java.util.Map">
        select strategy_name strategyName,
            sum(add_score) add_score,
            sum(bet_coins) bet_coins,
            up,
            down,
            sum(controls) controls,
            sum(sha) sha,
            sum(song) song,
            sum(games) games
        from data_game_result
        <where>
            <if test="tid != 0"> and channel in (select t_id from sys_tenant where t_type = '2' and ancestors like CONCAT('%', #{tid}, '%'))</if>
            <if test="strategyId != 0"> and strategy_id = #{strategyId}</if>
            <if test="day != null and day != ''"> and day = #{day}</if>
        </where>
        group by strategy_id,day, strategy_name,up,down
    </select>
</mapper>
